# =========================================================
# ZMK / Zephyr config (macOS + iPadOS BLE stability)
# =========================================================

# --- Device basics ---
CONFIG_ZMK_USB=y
CONFIG_ZMK_BLE=y
CONFIG_BT=y
CONFIG_BT_PERIPHERAL=y

# Ime uređaja (kako se vidi u BT listi)
CONFIG_BT_DEVICE_NAME="ZilpZalp"

# Koliko uređaja pamti (i koliko konekcija)
CONFIG_BT_MAX_CONN=1
CONFIG_BT_MAX_PAIRED=5

# --- Key fix: avoid "stuck BLE after long laptop sleep" ---
# Nemoj 0 (nikad ne spava) na macOS-u — to često dovodi do stanja
# gde se posle mnogo sati ne vrati konekcija dok ne ubodeš USB.
#
# 3600000 ms = 1 sat
# Ako želiš agresivnije: 1800000 (30 min)
CONFIG_ZMK_IDLE_SLEEP_TIMEOUT=3600000
CONFIG_ZMK_SLEEP=y

# --- Connection parameter preferences (stabilnije na macOS/iPadOS) ---
# (Vrednosti su u units od 1.25ms za interval, timeout u 10ms)
# Ove vrednosti su “umerene”: stabilno + ok latencija.
CONFIG_BT_PERIPHERAL_PREF_MIN_INT=24
CONFIG_BT_PERIPHERAL_PREF_MAX_INT=40
CONFIG_BT_PERIPHERAL_PREF_SLAVE_LATENCY=0
CONFIG_BT_PERIPHERAL_PREF_TIMEOUT=400

# --- HID over GATT ---
CONFIG_BT_HIDS=y
CONFIG_BT_HIDS_MAX_CLIENT_COUNT=1